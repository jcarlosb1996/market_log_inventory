{% extends "marketlog/base.html" %} {% block title %}Inventory · MarketLog
{%endblock%} {% block content %}
<h1 class="mb-3">Inventory</h1>

<!-- Summary counters -->
<div class="row g-3 mb-3">
  <div class="col-md-3">
    <div class="card">
      <div class="card-body">
        <div class="fw-semibold text-muted">Distinct Items</div>
        <div class="fs-4">{{ stats.distinct_items }}</div>
      </div>
    </div>
  </div>
  <div class="col-md-3">
    <div class="card">
      <div class="card-body">
        <div class="fw-semibold text-muted">In-Stock Items</div>
        <div class="fs-4">{{ stats.in_stock_items }}</div>
      </div>
    </div>
  </div>
  <div class="col-md-3">
    <div class="card">
      <div class="card-body">
        <div class="fw-semibold text-muted">Sold-Out Items</div>
        <div class="fs-4">{{ stats.sold_out_items }}</div>
      </div>
    </div>
  </div>
  <div class="col-md-3">
    <div class="card">
      <div class="card-body">
        <div class="fw-semibold text-muted">Units in Stock</div>
        <div class="fs-4">{{ stats.units_in_stock }}</div>
      </div>
    </div>
  </div>
</div>

<!-- Sales breakdown -->
<div class="row g-3 mb-4">
  <div class="col-md-4">
    <div class="card border-success">
      <div class="card-body">
        <div class="fw-semibold text-muted">Total Units Sold</div>
        <div class="fs-4">{{ stats.sold_units }}</div>
      </div>
    </div>
  </div>
  <div class="col-md-4">
    <div class="card border-primary">
      <div class="card-body">
        <div class="fw-semibold text-muted">Sold on Facebook</div>
        <div class="fs-4">{{ stats.sold_fb }}</div>
      </div>
    </div>
  </div>
  <div class="col-md-4">
    <div class="card border-warning">
      <div class="card-body">
        <div class="fw-semibold text-muted">Sold on eBay</div>
        <div class="fs-4">{{ stats.sold_ebay }}</div>
      </div>
    </div>
  </div>
</div>

<table class="table table-bordered bg-white">
  <thead class="table-light">
    <tr>
      <th>Photo</th>
      <th>Title</th>
      <th>Cost (per unit)</th>
      <th>Ask (per unit)</th>
      <th>Qty</th>
      <th>Status</th>
      <th>Actions</th>
      <th>Remove</th>
    </tr>
  </thead>
  <tbody>
    {% for it in items %}
    <tr>
      <td>
        {% if it.image %}<img src="{{ it.image.url }}" width="80" />{% endif %}
      </td>
      <td>{{ it.title }}</td>
      <td>${{ it.cost }}</td>
      <td>${{ it.ask_price }}</td>
      <td>{{ it.quantity }}</td>
      <td>
        {% if it.quantity == 0 %}<span class="badge bg-secondary">Sold Out</span
        >{% else %}<span class="badge bg-success">In Stock</span>{% endif %}
      </td>
      <td>
        {% if it.quantity > 0 %}
        <a
          class="btn btn-sm btn-outline-primary"
          href="{% url 'sell' it.id 'FACEBOOK' %}"
          >Sold on Facebook</a
        >
        <a
          class="btn btn-sm btn-outline-warning ms-2"
          href="{% url 'sell' it.id 'EBAY' %}"
          >Sold on eBay</a
        >
        {% else %}
        <span class="text-muted"
          >Sold — {% if it.sold_at %}{{ it.sold_at|date:"Y-m-d H:i" }}
          {%endif%}</span
        >
        {% endif %}
      </td>
      <td>
        <form
          method="post"
          action="{% url 'delete_item' it.id %}"
          style="display: inline"
        >
          {% csrf_token %}
          <button
            type="submit"
            class="btn btn-sm btn-outline-danger"
            onclick="return confirm('Are you sure you want to delete this item?');"
          >
            Delete
          </button>
        </form>
      </td>
    </tr>
    {% empty %}
    <tr>
      <td colspan="7" class="text-center text-muted">No items yet.</td>
    </tr>
    {% endfor %}
  </tbody>
</table>
{% endblock %}
