{% extends "marketlog/base.html" %} {% block title %}Sales History Â· MarketLog
{%endblock%} {% block content %}
<h1 class="mb-3">Sales History</h1>

<table class="table table-bordered bg-white">
  <thead class="table-light">
    <tr>
      <th>Date</th>
      <th>Item</th>
      <th>Channel</th>
      <th>Qty</th>
      <th>Sale Price</th>
      <th>Fees</th>
      <th>Net Profit</th>
      <th>Actions</th>
    </tr>
  </thead>
  <tbody>
    {% for s in sales %}
    <tr>
      <td>{{ s.created_at|date:"Y-m-d H:i" }}</td>
      <td>{{ s.item.title }}</td>
      <td>
        {% if s.channel == "FACEBOOK" %}
        <span class="badge bg-primary">Facebook</span>
        {% elif s.channel == "EBAY" %}
        <span class="badge bg-warning text-dark">eBay</span>
        {% else %}
        <span class="badge bg-secondary">{{ s.channel }}</span>
        {% endif %}
      </td>
      <td>{{ s.quantity }}</td>
      <td>${{ s.sale_price }}</td>
      <td>${{ s.fee_amount }}</td>
      <td>
        {% if s.net_profit > 0 %}
        <span class="text-success">${{ s.net_profit }}</span>
        {% else %}
        <span class="text-danger">${{ s.net_profit }}</span>
        {% endif %}
      </td>
      <td>
        <form
          method="post"
          action="{% url 'delete_sale' s.id %}"
          style="display: inline"
        >
          {% csrf_token %}
          <button
            type="submit"
            class="btn btn-sm btn-outline-danger"
            onclick="return confirm('Are you sure you want to delete this sale?');"
          >
            Delete
          </button>
        </form>
      </td>
    </tr>
    {% empty %}
    <tr>
      <td colspan="7" class="text-center text-muted">No sales yet.</td>
    </tr>
    {% endfor %}
  </tbody>
</table>

<h3 class="mt-4">Totals</h3>
<ul class="list-unstyled">
  <li>
    <strong>Gross:</strong> ${{ totals.gross|default:"0.00"|floatformat:2 }}
  </li>
  <li>
    <strong>Fees:</strong> ${{ totals.fees|default:"0.00"|floatformat:2 }}
  </li>
  <li><strong>Net:</strong> ${{ totals.net|default:"0.00"|floatformat:2 }}</li>
</ul>
{% endblock %}
